import{a as Y,b as Z}from"./chunk-WGN7SJYJ.js";import{Aa as J,Ba as K,Ca as Q,Da as W,Fa as X,Ga as ee,Ha as te,ca as q,fa as G,ia as L,ka as U,ma as A,na as B,oa as V,qa as x,ra as z,ta as H,ua as O,wa as R,xa as $}from"./chunk-H7GFYF4N.js";import{$b as b,Bb as u,Cb as E,Db as I,Eb as T,Fb as a,Gb as n,Hb as c,O as S,Ob as D,Qb as f,Qc as k,Za as g,Zb as m,_b as w,ab as s,ac as N,bb as p,cc as _,da as y,gc as P,hc as j,ia as F,na as h,ob as M,p as C,ub as d,wb as v}from"./chunk-4N56W5ZJ.js";var ne=(()=>{let e=class e{constructor(i){this._requestHelper=i}query(i){return C([])}trade(i,r){return this._requestHelper.post("/transactions",{to_member:i,amount:r})}};e.\u0275fac=function(r){return new(r||e)(F(X))},e.\u0275prov=y({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function oe(t,e){if(t&1&&(a(0,"li"),m(1),P(2,"date"),n()),t&2){let o=e.$implicit;s(),N("On ",j(2,4,o.created_at),", amount of ",o.amount," has been transferred from ",o.from_member.name," to ",o.to_member.name,". ")}}function me(t,e){if(t&1&&(a(0,"ul"),I(1,oe,3,6,"li",null,E),n()),t&2){let o=f(2);s(),T(o.transactions)}}function se(t,e){t&1&&(a(0,"div",0),m(1,"No transactions found."),n())}function le(t,e){if(t&1&&d(0,me,3,0,"ul")(1,se,2,0,"div",0),t&2){let o=f();u((o.transactions==null?null:o.transactions.length)>0?0:1)}}var re=(()=>{let e=class e{constructor(i){this._transactionService=i,this.transactions=[],this.isLoading=M(!0)}ngOnInit(){this._getTransactions()}_getTransactions(){this.isLoading.set(!0),this._transactionService.query().pipe(S(()=>this.isLoading.set(!1))).subscribe(i=>{this.transactions=i})}};e.\u0275fac=function(r){return new(r||e)(p(ne))},e.\u0275cmp=h({type:e,selectors:[["app-transactions"]],standalone:!0,features:[_],decls:1,vars:1,consts:[[1,"text-center","mt-4"]],template:function(r,l){r&1&&d(0,le,2,1),r&2&&u(l.isLoading()?-1:0)},dependencies:[k]});let t=e;return t})();function ce(t,e){if(t&1&&(a(0,"p"),m(1),n(),a(2,"p"),m(3),n(),c(4,"img",7),a(5,"p"),m(6),n()),t&2){let o=f();s(),w(o.member.name),s(2),b("",o.member.email," "),s(),v("src",o.member.picture,g),s(2),b("Balance: ",o.member.balance,"")}}var Pe=(()=>{let e=class e{constructor(i,r){this._appDataService=i,this._securityService=r,this.mainForm=this._constructForm()}ngOnInit(){this._appDataService.currentUser$.subscribe(i=>{this.member=i,this.mainForm.patchValue({name:this.member?.name,picture:this.member?.picture})})}_constructForm(){return new V({name:new x(null,[U.required]),picture:new x(null)})}update(){let i=this._preparePayload();this._securityService.updateCurrentUser(i).subscribe(()=>{this._appDataService.initializeUser(),this.mainForm.markAsPristine()})}_preparePayload(){let i={};return this.mainForm.controls.name.dirty&&(i.name=this.mainForm.controls.name.value),this.mainForm.controls.picture.dirty&&(i.picture=this.mainForm.controls.picture.value),i}};e.\u0275fac=function(r){return new(r||e)(p(te),p(ee))},e.\u0275cmp=h({type:e,selectors:[["app-member-profile"]],standalone:!0,features:[_],decls:25,vars:3,consts:[[1,"text-align-center"],[1,"p-4","w-50"],[3,"formGroup"],[1,"w-100","mt-2"],["matInput","","placeholder","Name","formControlName","name"],["matInput","","placeholder","Enter image url","formControlName","picture"],["mat-flat-button","","color","primary","aria-label","Add row",1,"mt-2",3,"click","disabled"],["alt","Profile image","width","100","height","100",3,"src"]],template:function(r,l){r&1&&(a(0,"section",0)(1,"h1"),m(2,"Profile"),n(),d(3,ce,7,4),n(),c(4,"mat-divider"),a(5,"section",1)(6,"h3"),m(7,"Update profile"),n(),a(8,"form",2)(9,"mat-form-field",3)(10,"mat-label"),m(11,"Name"),n(),c(12,"input",4),n(),a(13,"mat-form-field",3)(14,"mat-label"),m(15,"Profile image url"),n(),c(16,"input",5),n(),a(17,"button",6),D("click",function(){return l.update()}),a(18,"mat-icon"),m(19,"save"),n(),m(20," Save "),n()()(),a(21,"section",1)(22,"h3"),m(23,"Transaction history"),n(),c(24,"app-transactions"),n()),r&2&&(s(3),u(l.member?3:-1),s(5),v("formGroup",l.mainForm),s(9),v("disabled",!l.mainForm.dirty||!l.mainForm.valid))},dependencies:[Z,Y,R,z,L,A,B,H,O,K,J,$,W,Q,q,G,re]});let t=e;return t})();export{Pe as MemberProfileComponent};
