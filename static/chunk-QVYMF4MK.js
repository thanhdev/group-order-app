import{a as _e,b as ue}from"./chunk-TQ27Q5TT.js";import{$a as ce,Aa as Q,Ca as W,Ea as X,Ha as Y,Ja as Z,La as ee,Ma as te,Na as ie,Pa as S,Qa as ne,Sa as oe,Ta as ae,Va as re,Wa as me,Za as le,_a as se,ab as de,bb as pe,db as fe,eb as Ce,fb as he,h as q,ja as V,m as U,na as k,oa as G,pa as L,ra as $,sa as z,ua as B,va as O,xa as J,ya as K}from"./chunk-DJYSYX2K.js";import{$b as u,Bb as _,Fb as a,Gb as o,Hb as d,Ib as h,Jb as b,Lb as P,O as y,Ob as R,Qb as f,Qc as j,Za as w,Zb as m,_b as H,ab as l,bb as C,cc as v,da as D,gc as N,hc as A,ia as I,na as x,ob as g,t as T,ub as s,va as E,wa as F,wb as c}from"./chunk-4N56W5ZJ.js";var M=class e{constructor(t){Object.assign(this,t)}static createFromApiModel(t){return new e({id:t.id,amount:t.amount,createdAt:new Date(t.created_at),fromMember:t.from_member,toMember:t.to_member,transactionType:t.type})}};var xe=(()=>{let t=class t{constructor(i){this._requestHelper=i}query(i){return this._requestHelper.get("/transactions",{params:i})}trade(i,r){return this._requestHelper.post("/transactions",{to_member:i,amount:r})}};t.\u0275fac=function(r){return new(r||t)(I(fe))},t.\u0275prov=D({token:t,factory:t.\u0275fac,providedIn:"root"});let e=t;return e})();function Se(e,t){e&1&&(a(0,"th",11),m(1," No. "),o())}function Te(e,t){if(e&1&&(a(0,"td",12),m(1),o()),e&2){let n=t.index;l(),u(" ",n+1," ")}}function ye(e,t){e&1&&(a(0,"th",11),m(1," Date "),o())}function De(e,t){if(e&1&&(a(0,"td",12),m(1),N(2,"date"),o()),e&2){let n=t.$implicit;l(),u(" ",A(2,1,n.createdAt)," ")}}function Ie(e,t){e&1&&(a(0,"th",11),m(1," From "),o())}function Ee(e,t){if(e&1&&(a(0,"td",12),d(1,"app-member-display",13),o()),e&2){let n=t.$implicit;l(),c("member",n.fromMember)}}function Fe(e,t){e&1&&(a(0,"th",11),m(1," To "),o())}function we(e,t){if(e&1&&(a(0,"td",12),d(1,"app-member-display",13),o()),e&2){let n=t.$implicit;l(),c("member",n.toMember)}}function ge(e,t){e&1&&(a(0,"th",11),m(1," Amount "),o())}function Pe(e,t){if(e&1&&(a(0,"td",12),m(1),o()),e&2){let n=t.$implicit;l(),u(" ",n.amount," ")}}function Re(e,t){e&1&&d(0,"tr",14)}function He(e,t){e&1&&d(0,"tr",15)}function Ne(e,t){if(e&1&&(a(0,"table",0),h(1,2),s(2,Se,2,0,"th",3)(3,Te,2,1,"td",4),b(),h(4,5),s(5,ye,2,0,"th",3)(6,De,3,3,"td",4),b(),h(7,6),s(8,Ie,2,0,"th",3)(9,Ee,2,1,"td",4),b(),h(10,7),s(11,Fe,2,0,"th",3)(12,we,2,1,"td",4),b(),h(13,8),s(14,ge,2,0,"th",3)(15,Pe,2,1,"td",4),b(),s(16,Re,1,0,"tr",9)(17,He,1,0,"tr",10),o()),e&2){let n=f(2);c("dataSource",n.transactions),l(16),c("matHeaderRowDef",n.displayedColumns),l(),c("matRowDefColumns",n.displayedColumns)}}function Ae(e,t){e&1&&(a(0,"div",1),m(1,"No transactions found."),o())}function je(e,t){if(e&1&&s(0,Ne,18,3,"table",0)(1,Ae,2,0,"div",1),e&2){let n=f();_((n.transactions==null?null:n.transactions.length)>0?0:1)}}var ve=(()=>{let t=class t{constructor(i){this._transactionService=i,this.displayedColumns=["index","date","from","to","amount"],this.isLoading=g(!0)}ngOnInit(){this._getTransactions()}_getTransactions(){let i=this.specificMemberId?{member:this.specificMemberId}:{};this.isLoading.set(!0),this._transactionService.query(i).pipe(y(()=>this.isLoading.set(!1)),T(r=>r.map(p=>M.createFromApiModel(p)))).subscribe(r=>this.transactions=r)}};t.\u0275fac=function(r){return new(r||t)(C(xe))},t.\u0275cmp=x({type:t,selectors:[["app-transactions"]],inputs:{specificMemberId:"specificMemberId"},standalone:!0,features:[v],decls:1,vars:1,consts:[["mat-table","",3,"dataSource"],[1,"text-center","mt-4"],["matColumnDef","index"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","date"],["matColumnDef","from"],["matColumnDef","to"],["matColumnDef","amount"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-header-cell",""],["mat-cell",""],[3,"member"],["mat-header-row",""],["mat-row",""]],template:function(r,p){r&1&&s(0,je,2,1),r&2&&_(p.isLoading()?-1:0)},dependencies:[j,W,k,L,O,$,G,J,z,B,K,Q,pe]});let e=t;return e})();function qe(e,t){if(e&1&&(a(0,"p"),m(1),o(),a(2,"p"),m(3),o(),d(4,"img",3),a(5,"p"),m(6),o()),e&2){let n=f();l(),H(n.member.name),l(2),u("",n.member.email," "),l(),c("src",n.member.picture,w),l(2),u("Balance: ",n.member.balance,"")}}function Ue(e,t){if(e&1){let n=P();a(0,"section",1)(1,"h3"),m(2,"Update profile"),o(),a(3,"form",4)(4,"mat-form-field",5)(5,"mat-label"),m(6,"Name"),o(),d(7,"input",6),o(),a(8,"mat-form-field",5)(9,"mat-label"),m(10,"Profile image url"),o(),d(11,"input",7),o(),a(12,"button",8),R("click",function(){E(n);let r=f();return F(r.update())}),a(13,"mat-icon"),m(14,"save"),o(),m(15," Save "),o()()()}if(e&2){let n=f();l(3),c("formGroup",n.mainForm),l(9),c("disabled",!n.mainForm.dirty||!n.mainForm.valid)}}function Ve(e,t){if(e&1&&d(0,"app-transactions",2),e&2){let n=f();c("specificMemberId",n.member.id)}}var ft=(()=>{let t=class t{constructor(i,r,p){this._appDataService=i,this._profileService=r,this._activatedRoute=p,this._memberId=this._activatedRoute.snapshot.params.memberId,this.mainForm=this._constructForm()}ngOnInit(){this._memberId?this._profileService.getMember(this._memberId).subscribe(i=>{this._bindData(i)}):this.isMyProfile=!0,this._appDataService.currentUser$.subscribe(i=>{this._currentUserId=i?.id,this.isMyProfile&&this._bindData(i)})}_constructForm(){return new ie({name:new S(null,[Z.required]),picture:new S(null)})}_bindData(i){this.isMyProfile=this._currentUserId===i.id,this.member=i,this.mainForm.patchValue({name:this.member?.name,picture:this.member?.picture})}update(){let i=this._preparePayload();this._profileService.updateCurrentUser(i).subscribe(()=>{this._appDataService.initializeUser(),this.mainForm.markAsPristine()})}_preparePayload(){let i={};return this.mainForm.controls.name.dirty&&(i.name=this.mainForm.controls.name.value),this.mainForm.controls.picture.dirty&&(i.picture=this.mainForm.controls.picture.value),i}};t.\u0275fac=function(r){return new(r||t)(C(he),C(Ce),C(q))},t.\u0275cmp=x({type:t,selectors:[["app-member-profile"]],standalone:!0,features:[v],decls:10,vars:3,consts:[[1,"text-align-center"],[1,"p-4","w-50"],[3,"specificMemberId"],["alt","Profile image","width","100","height","100",3,"src"],[3,"formGroup"],[1,"w-100","mt-2"],["matInput","","placeholder","Name","formControlName","name"],["matInput","","placeholder","Enter image url","formControlName","picture"],["mat-flat-button","","color","primary","aria-label","Add row",1,"mt-2",3,"click","disabled"]],template:function(r,p){r&1&&(a(0,"section",0)(1,"h1"),m(2,"Profile"),o(),s(3,qe,7,4),o(),d(4,"mat-divider"),s(5,Ue,16,2,"section",1),a(6,"section",1)(7,"h3"),m(8,"Transaction history"),o(),s(9,Ve,1,1,"app-transactions",2),o()),r&2&&(l(3),_(p.member?3:-1),l(2),_(p.isMyProfile?5:-1),l(4),_(p.member?9:-1))},dependencies:[ue,_e,re,ne,Y,ee,te,oe,ae,se,le,me,de,ce,V,X,ve,U]});let e=t;return e})();export{ft as MemberProfileComponent};
